# Crank Service Environment
# Copy to .env and fill in values

# Solana RPC (use dedicated RPC for mainnet â€” Helius/Triton)
RPC_URL=http://ash.rpc.gadflynode.com:80
# Optional explicit WS endpoint (recommended if provider WS port/host differs)
# RPC_WS_URL=ws://ash.rpc.gadflynode.com:81

# Network: devnet or mainnet
NETWORK=devnet

# Dedicated crank keypair file (same format as solana-keygen output)
# Must be different from ../keypar.json (guarded in code by default)
CRANK_KEYPAIR_PATH=../service-wallet.json

# Backward-compat alias (deprecated; prefer CRANK_KEYPAIR_PATH)
# SERVICE_WALLET_PATH=../service-wallet.json

# Emergency override only (not recommended)
# ALLOW_CRANK_KEYPAR_REUSE=1

# Firebase (for round archiving)
FIREBASE_DATABASE_URL=https://solanacasino-ab95c-default-rtdb.europe-west1.firebasedatabase.app

# Crank settings
POLL_INTERVAL_MS=3000
LOCK_BUFFER_SEC=3
AUTO_CLAIM_TIMEOUT_SEC=120
CLOSE_DELAY_SEC=5

# Tx prioritization (mainnet-safe defaults)
CRANK_COMPUTE_UNIT_LIMIT=600000
CRANK_PRIORITY_FEE_MICROLAMPORTS=20000

# Terminal cleanup retry/backoff (Claimed/Cancelled rounds)
CLEANUP_BACKOFF_MIN_SEC=5
CLEANUP_BACKOFF_MAX_SEC=60

# Max participant PDA closes per tick for terminal cleanup
PARTICIPANT_CLEANUP_BATCH=12

# Health / observability logs (set 0 to disable periodic health snapshots)
HEALTH_LOG_INTERVAL_SEC=60

# On startup, scan the last N rounds and recover Settled/Claimed/Cancelled rounds
# into background cleanup tracking (survives crank restarts)
STARTUP_BACKFILL_SCAN_ROUNDS=50

# Stuck round warnings (status age thresholds)
STUCK_LOCKED_SEC=90
STUCK_VRF_REQUESTED_SEC=180
STUCK_SETTLED_SEC=300
STUCK_CANCELLED_SEC=180

# Re-log stuck warning for same round/status no more often than this
STUCK_WARN_REPEAT_SEC=60
